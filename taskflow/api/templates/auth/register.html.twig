<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Регистрация</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 400px; margin: 50px auto; }
        input, button { display: block; margin: 10px 0; padding: 8px; width: 100%; }
        .error { color: red; }
        a { display: block; margin-top: 15px; }
    </style>
</head>
<body>
<h2>Регистрация</h2>
<form id="registerForm">
    <input type="email" id="email" placeholder="Email" required />
    <input type="password" id="password" placeholder="Пароль" required />
    <button type="submit">Зарегистрироваться</button>
</form>
<p class="error" id="error"></p>
<a href="/">Уже есть аккаунт? Войти</a>

<script>
    const API_URL = 'http://localhost:8080/api';

    document.getElementById('registerForm').addEventListener('submit', async e => {
        e.preventDefault();
        const errorEl = document.getElementById('error');
        errorEl.textContent = '';

        const email = document.getElementById('email').value;
        const password = document.getElementById('password').value;

        try {
            const res = await fetch(`${API_URL}/register`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({email, password}),
            });

            if (!res.ok) {
                const text = await res.text();
                throw new Error(text || 'Ошибка регистрации');
            }

            alert('Регистрация успешна! Теперь войдите.');
            window.location.href = '/';

        } catch (err) {
            errorEl.textContent = err.message;
        }
    });
</script>
</body>
</html>
